(()=>{"use strict";document.body.addEventListener("mousedown",(t=>{t.target.classList.contains("form-field")||t.preventDefault()})),document.addEventListener("DOMContentLoaded",(()=>{fetch("http://localhost:7070?method=allTickets").then((t=>t.json())).then((t=>{t.forEach((t=>{let e=document.createElement("div");e.classList.add("ticket"),e.innerHTML='\n                    <input type="checkbox" class="ticket-checkbox">\n                    <div class="ticket-text-content">\n                    <div class="ticket-title"></div>\n                    <div class="ticket-description"></div>  \n                    </div>\n                    <div class="ticket-date"></div>\n                    <div class="ticket-btns">\n                    <div class="btn edit-btn">&#10000;</div>\n                    <div class="btn remove-btn">&#x2715;</div>\n                    </div>\n                ',e.querySelector(".ticket-title").textContent=t.name.trim(),e.querySelector(".ticket-description").textContent=t.description.trim();const n=e.querySelector(".ticket-date"),i=t.created,c=new Date(i).toLocaleString();n.textContent=c,e.setAttribute("id",t.id),document.querySelector("#ticket-box").appendChild(e)}))})).then((()=>{!function(){const t=document.getElementsByClassName("ticket");Array.from(t).forEach((t=>t.addEventListener("click",(e=>{const n=t.querySelector(".ticket-description");e.target.classList.contains("btn")||e.target.classList.contains("ticket-checkbox")||!n.textContent||(n.classList.contains("hide-description")?(n.classList.remove("hide-description"),n.classList.add("show-description")):n.classList.contains("show-description")?(n.classList.remove("show-description"),n.classList.add("hide-description")):n.classList.add("show-description"))}))))}(),document.querySelector(".add-ticket-btn").addEventListener("click",(()=>{document.querySelector(".ticket-form").classList.remove("hide-form")})),document.querySelectorAll(".cancel-btn").forEach((t=>t.addEventListener("click",(t=>{t.target.parentElement.parentElement.classList.add("hide-form")})))),Array.from(document.querySelectorAll(".edit-btn")).forEach((t=>t.addEventListener("click",(()=>{const e=document.querySelector(".edit-ticket-form");e.classList.remove("hide-form");const n=t.parentElement.parentElement,i=n.querySelector(".ticket-title").textContent,c=n.querySelector(".ticket-description").textContent,s=n.id,d=document.querySelector(".update-title");d.value=i;const o=document.querySelector(".update-description");o.value=c,e.addEventListener("submit",(()=>{if(d.value!==i||o.value!==c&&!d.value.trim()){const t={name:d.value,description:o.value};fetch(`http://localhost:7070?method=updateById&id=${s}`,{method:"POST",body:JSON.stringify(t)})}}))})))),Array.from(document.querySelectorAll(".remove-btn")).forEach((t=>t.addEventListener("click",(()=>{const e=t.parentElement.parentElement,n=document.querySelector(".remove-ticket-form");n.classList.remove("hide-form"),n.addEventListener("submit",(t=>{t.preventDefault();let i=new XMLHttpRequest;i.open("GET",`http://localhost:8080?method=deleteById&id=${e.id}`),i.send(),i.addEventListener("load",(()=>{e.remove(),n.classList.add("hide-form")}))}))}))))}))})),function(){const t=document.querySelector(".add-ticket-form"),e=document.querySelector(".new-title");t.addEventListener("submit",(()=>{if(e.value.trim()){const t={name:document.querySelector(".new-title").value,description:document.querySelector(".new-description").value};fetch("http://localhost:7070?method=createTicket",{method:"POST",body:JSON.stringify(t)}).then((t=>t.json())).then((t=>{const e=document.createElement("div");e.classList.add("ticket"),e.innerHTML='\n                <div class="ticket-content">\n                  <input type="checkbox" class="ticket-checkbox">\n                  <div class="ticket-text-content">\n                    <div class="ticket-title"></div>\n                    <div class="ticket-description"></div>  \n                  </div>\n                  <div class="ticket-date"></div>\n                  <div class="ticket-btns">\n                    <div class="btn edit-btn">&#10000;</div>\n                    <div class="btn remove-btn">&#x2715;</div>\n                  </div>\n                </div>',e.querySelector(".ticket-title").textContent=t.name,e.querySelector(".ticket-description").textContent=t.description,document.querySelector("#ticket-box").appendChild(e)}))}else alert("Форма не заполнена!")}))}()})();