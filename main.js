(()=>{"use strict";document.body.addEventListener("mousedown",(t=>{t.target.classList.contains("form-field")||t.preventDefault()})),document.addEventListener("DOMContentLoaded",(()=>{fetch("https://github.com/petr-firsov/backend:7070?method=allTickets").then((t=>t.json())).then((t=>{t.forEach((t=>{let e=document.createElement("div");e.classList.add("ticket"),e.innerHTML='\n                    <input type="checkbox" class="ticket-checkbox">\n                    <div class="ticket-text-content">\n                    <div class="ticket-title"></div>\n                    <div class="ticket-description"></div>  \n                    </div>\n                    <div class="ticket-date"></div>\n                    <div class="ticket-btns">\n                    <div class="btn edit-btn">&#10000;</div>\n                    <div class="btn remove-btn">&#x2715;</div>\n                    </div>\n                ',e.querySelector(".ticket-title").textContent=t.name.trim(),e.querySelector(".ticket-description").textContent=t.description.trim();const i=e.querySelector(".ticket-date"),n=t.created,c=new Date(n).toLocaleString();i.textContent=c,e.setAttribute("id",t.id),document.querySelector("#ticket-box").appendChild(e)}))})).then((()=>{!function(){const t=document.getElementsByClassName("ticket");Array.from(t).forEach((t=>t.addEventListener("click",(e=>{const i=t.querySelector(".ticket-description");e.target.classList.contains("btn")||e.target.classList.contains("ticket-checkbox")||!i.textContent||(i.classList.contains("hide-description")?(i.classList.remove("hide-description"),i.classList.add("show-description")):i.classList.contains("show-description")?(i.classList.remove("show-description"),i.classList.add("hide-description")):i.classList.add("show-description"))}))))}(),document.querySelector(".add-ticket-btn").addEventListener("click",(()=>{document.querySelector(".ticket-form").classList.remove("hide-form")})),document.querySelectorAll(".cancel-btn").forEach((t=>t.addEventListener("click",(t=>{t.target.parentElement.parentElement.classList.add("hide-form")})))),Array.from(document.querySelectorAll(".edit-btn")).forEach((t=>t.addEventListener("click",(()=>{const e=document.querySelector(".edit-ticket-form");e.classList.remove("hide-form");const i=t.parentElement.parentElement,n=i.querySelector(".ticket-title").textContent,c=i.querySelector(".ticket-description").textContent,s=i.id,d=document.querySelector(".update-title");d.value=n;const o=document.querySelector(".update-description");o.value=c,e.addEventListener("submit",(()=>{if(d.value!==n||o.value!==c&&!d.value.trim()){const t={name:d.value,description:o.value};fetch(`https://github.com/petr-firsov/backend?method=updateById&id=${s}`,{method:"POST",body:JSON.stringify(t)})}}))})))),Array.from(document.querySelectorAll(".remove-btn")).forEach((t=>t.addEventListener("click",(()=>{const e=t.parentElement.parentElement,i=document.querySelector(".remove-ticket-form");i.classList.remove("hide-form"),i.addEventListener("submit",(t=>{t.preventDefault();let n=new XMLHttpRequest;n.open("GET",`https://github.com/petr-firsov/backend?method=deleteById&id=${e.id}`),n.send(),n.addEventListener("load",(()=>{e.remove(),i.classList.add("hide-form")}))}))}))))}))})),function(){const t=document.querySelector(".add-ticket-form"),e=document.querySelector(".new-title");t.addEventListener("submit",(()=>{if(e.value.trim()){const t={name:document.querySelector(".new-title").value,description:document.querySelector(".new-description").value};fetch("https://github.com/petr-firsov/backend?method=createTicket",{method:"POST",body:JSON.stringify(t)}).then((t=>t.json())).then((t=>{const e=document.createElement("div");e.classList.add("ticket"),e.innerHTML='\n                <div class="ticket-content">\n                  <input type="checkbox" class="ticket-checkbox">\n                  <div class="ticket-text-content">\n                    <div class="ticket-title"></div>\n                    <div class="ticket-description"></div>  \n                  </div>\n                  <div class="ticket-date"></div>\n                  <div class="ticket-btns">\n                    <div class="btn edit-btn">&#10000;</div>\n                    <div class="btn remove-btn">&#x2715;</div>\n                  </div>\n                </div>',e.querySelector(".ticket-title").textContent=t.name,e.querySelector(".ticket-description").textContent=t.description,document.querySelector("#ticket-box").appendChild(e)}))}else alert("Форма не заполнена!")}))}()})();